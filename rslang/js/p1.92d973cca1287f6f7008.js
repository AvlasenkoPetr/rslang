(()=>{"use strict";var t={126:(t,e,s)=>{s.r(e)},662:(t,e,s)=>{s.r(e)},512:(t,e,s)=>{s.r(e)},482:(t,e,s)=>{s.r(e)},974:(t,e,s)=>{s.r(e)},817:(t,e,s)=>{s.r(e)},448:(t,e,s)=>{s.r(e)},896:(t,e,s)=>{s.r(e)},863:(t,e,s)=>{s.r(e)},155:(t,e,s)=>{s.r(e)},90:(t,e,s)=>{s.r(e)},658:(t,e,s)=>{s.r(e)},264:(t,e,s)=>{s.r(e)},87:(t,e,s)=>{s.r(e)},700:(t,e,s)=>{s.r(e)},510:(t,e,s)=>{s.r(e)},352:function(t,e,s){var n=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(i,r){function a(t){try{d(n.next(t))}catch(t){r(t)}}function o(t){try{d(n.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,o)}d((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Fetch=void 0;const i=s(718);e.Fetch=class{GET_WORDS(t="0",e="0"){return n(this,void 0,void 0,(function*(){const s={url:`words?group=${t}&page=${e}`,method:"GET",token:null};return yield this.sendRequest(s)}))}GET_WORD_BY_ID(t){return n(this,void 0,void 0,(function*(){const e={url:`words/${t}`,method:"GET",token:null};return yield this.sendRequest(e)}))}GET_USER(){return n(this,void 0,void 0,(function*(){const t={url:`users/${(0,i.getUserInfo)().userId}`,method:"GET",token:(0,i.getUserInfo)().token};return yield this.sendRequest(t)}))}CREATE_USER(t){return n(this,void 0,void 0,(function*(){const e={url:"users",method:"POST",token:null,body:JSON.stringify({name:t.name,email:t.email,password:t.password})};return yield this.sendRequest(e)}))}UPDATE_USER(t){return n(this,void 0,void 0,(function*(){const e={url:`users/${(0,i.getUserInfo)().userId}`,method:"PUT",token:(0,i.getUserInfo)().token,body:JSON.stringify({email:t.email,password:t.password})};return yield this.sendRequest(e)}))}DELETE_USER(){return n(this,void 0,void 0,(function*(){const t={url:`users/${(0,i.getUserInfo)().userId}`,method:"DELETE",token:(0,i.getUserInfo)().token};return yield this.sendRequest(t)}))}GET_USER_TOKENS(){return n(this,void 0,void 0,(function*(){const t={url:`users/${(0,i.getUserInfo)().userId}/tokens`,method:"GET",token:(0,i.getUserInfo)().token};return yield this.sendRequest(t)}))}GET_USER_WORDS(){return n(this,void 0,void 0,(function*(){const t={url:`users/${(0,i.getUserInfo)().userId}/words`,method:"GET",token:(0,i.getUserInfo)().token};return yield this.sendRequest(t)}))}CREATE_USER_WORDS(t,e){return n(this,void 0,void 0,(function*(){const s={url:`users/${(0,i.getUserInfo)().userId}/words/${t}`,method:"POST",token:(0,i.getUserInfo)().token,body:JSON.stringify(e)};return yield this.sendRequest(s)}))}GET_USER_WORDS_BY_ID(t){return n(this,void 0,void 0,(function*(){const e={url:`users/${(0,i.getUserInfo)().userId}/words/${t}`,method:"GET",token:(0,i.getUserInfo)().token};return yield this.sendRequest(e)}))}UPDATE_USER_WORDS_BY_ID(t,e){return n(this,void 0,void 0,(function*(){const s={url:`users/${(0,i.getUserInfo)().userId}/words/${t}`,method:"PUT",token:(0,i.getUserInfo)().token,body:JSON.stringify(e)};return yield this.sendRequest(s)}))}DELETE_USER_WORDS_BY_ID(t){return n(this,void 0,void 0,(function*(){const e={url:`users/${(0,i.getUserInfo)().userId}/words/${t}`,method:"DELETE",token:(0,i.getUserInfo)().token};return yield this.sendRequest(e)}))}GET_AGGREGATED_WORDS(t){return n(this,void 0,void 0,(function*(){const e={url:`users/${(0,i.getUserInfo)().userId}/aggregatedWords?group=${t.group||""}&page=${t.page||""}&wordsPerPage=${t.wordsPerPage||""}&filter=${t.filter||""}`,method:"GET",token:(0,i.getUserInfo)().token};return yield this.sendRequest(e)}))}GET_AGGREGATED_WORDS_BY_ID(t){return n(this,void 0,void 0,(function*(){const e={url:`users/${(0,i.getUserInfo)().userId}/aggregatedWords/${t}`,method:"GET",token:(0,i.getUserInfo)().token};return yield this.sendRequest(e)}))}GET_STATISTICS(){return n(this,void 0,void 0,(function*(){const t={url:`users/${(0,i.getUserInfo)().userId}/statistics`,method:"GET",token:(0,i.getUserInfo)().token};return yield this.sendRequest(t)}))}UPDATE_STATISTICS(t){return n(this,void 0,void 0,(function*(){const e={url:`users/${(0,i.getUserInfo)().userId}/statistics`,method:"PUT",token:(0,i.getUserInfo)().token,body:JSON.stringify(t)};return yield this.sendRequest(e)}))}GET_USER_SETTINGS(){return n(this,void 0,void 0,(function*(){const t={url:`users/${(0,i.getUserInfo)().userId}/settings`,method:"GET",token:(0,i.getUserInfo)().token};return yield this.sendRequest(t)}))}UPDATE_USER_SETTINGS(t){return n(this,void 0,void 0,(function*(){const e={url:`users/${(0,i.getUserInfo)().userId}/settings`,method:"PUT",token:(0,i.getUserInfo)().token,body:JSON.stringify(t)};return yield this.sendRequest(e)}))}SIGN_IN(t){return n(this,void 0,void 0,(function*(){const e={url:"signin",method:"POST",token:null,body:JSON.stringify({email:t.email,password:t.password})};return yield this.sendRequest(e)}))}sendRequest(t){return n(this,void 0,void 0,(function*(){const e=yield fetch(`https://rss21q3-rslang.herokuapp.com/${t.url}`,{method:t.method,headers:{Authorization:`Bearer ${t.token}`,"Content-Type":"application/json",Accept:"application/json"},body:t.body});try{return yield e.json()}catch(t){throw{url:e.url,status:e.status,statusText:e.statusText}}}))}}},718:function(t,e,s){var n=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(i,r){function a(t){try{d(n.next(t))}catch(t){r(t)}}function o(t){try{d(n.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,o)}d((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.getLastPage=e.renderBookWithLS=e.checkStatsDay=e.makeEmptyStats=e.getTodayDate=e.isUserExists=e.setRandomNumber=e.getUserInfo=void 0;const i=s(352),r=s(73),a=s(250);function o(){const t=new Date;return`${t.getDate()}-${t.getMonth()}-${t.getFullYear()}`}function d(){return n(this,void 0,void 0,(function*(){const t={learnedWords:0,optional:{audioCall:{newWords:0,correct:0,wrong:0,maxRow:0},sprint:{newWords:0,correct:0,wrong:0,maxRow:0},date:o()}};yield(new i.Fetch).UPDATE_STATISTICS(t)}))}function l(){if(localStorage.getItem("lastBookLevel")&&localStorage.getItem("lastBookPage")){const t=localStorage.getItem("lastBookLevel")||"0",e=localStorage.getItem("lastBookPage")||"0";new r.BookPage(t).renderBookPage(e)}}e.getUserInfo=()=>{let t;return t=null!==localStorage.getItem("UserInfo")?JSON.parse(localStorage.getItem("UserInfo")):{token:"1",userId:"1"},t},e.setRandomNumber=t=>Math.floor(Math.random()*t),e.isUserExists=()=>!!localStorage.getItem("UserInfo"),e.getTodayDate=o,e.makeEmptyStats=d,e.checkStatsDay=function(){var t;return n(this,void 0,void 0,(function*(){const e=new i.Fetch;try{const s=yield e.GET_STATISTICS();(null===(t=null==s?void 0:s.optional)||void 0===t?void 0:t.date)!==o()&&(yield d())}catch(t){yield d()}}))},e.renderBookWithLS=l,e.getLastPage=function(){const t=new a.Router,e=localStorage.getItem("lastPage");e?"book"===e?(t.renderPage(e),l()):t.renderPage(e):t.renderPage()}},809:function(t,e,s){var n=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(i,r){function a(t){try{d(n.next(t))}catch(t){r(t)}}function o(t){try{d(n.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,o)}d((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GameResult=void 0,s(512);const r=s(428),a=s(179),o=s(352),d=i(s(910)),l=s(718);e.GameResult=class{constructor(t){this.gameName=t.gameName,this.newWordCounter=0,t.points&&(this.points=t.points),this.group=t.group,this.page=t.page,this.total=t.total,this.inRow=t.inRow,this.correctAnswers=t.answersArr.filter((t=>"true"===t.isRight)),this.correctAnswersCounter=this.correctAnswers.length,t.rightCount&&(this.correctAnswersCounter=t.rightCount),this.wrongAnswers=t.answersArr.filter((t=>"false"===t.isRight)),this.wrongAnswersCounter=this.wrongAnswers.length,t.wrongCount&&(this.wrongAnswersCounter=t.wrongCount),this.accuracy=Math.round(this.correctAnswersCounter/+this.total*100),this.accuracy||(this.accuracy=0),document.body.style.setProperty("--p",`${this.accuracy}`),"audioCall"==t.gameName&&this.checkIsNewWord(t)}updateStatistics(){return n(this,void 0,void 0,(function*(){try{const t=yield(new o.Fetch).GET_STATISTICS();delete t.id,t.optional?t.optional.audioCall?(t.optional.audioCall.correct+=this.correctAnswersCounter,t.optional.audioCall.wrong+=this.wrongAnswersCounter,t.optional.audioCall.newWords+=this.newWordCounter,t.optional.audioCall.maxRow<=this.inRow&&(t.optional.audioCall.maxRow=this.inRow)):Object.defineProperty(t.optional,"audioCall",{value:{correct:this.correctAnswersCounter,wrong:this.wrongAnswersCounter,newWords:this.newWordCounter,maxRow:this.inRow}}):Object.defineProperty(t,"optional",{value:{audioCall:{correct:this.correctAnswersCounter,wrong:this.wrongAnswersCounter,newWords:this.newWordCounter,maxRow:this.inRow}}}),yield(new o.Fetch).UPDATE_STATISTICS(t)}catch(t){const e={learnedWords:0,optional:{audioCall:{newWords:this.newWordCounter,correct:this.correctAnswersCounter,wrong:this.wrongAnswersCounter,maxRow:this.inRow}}};yield(new o.Fetch).UPDATE_STATISTICS(e)}}))}checkIsNewWord(t){return n(this,void 0,void 0,(function*(){const e=t.answersArr,s={wordsPerPage:"20",filter:`{"$and":[{"group": ${t.group}, "page": ${t.page}}]}`},n=(yield(new o.Fetch).GET_AGGREGATED_WORDS(s))[0].paginatedResults;e.forEach((t=>{const e=n.filter((e=>e._id===t.info.id))[0];e.userWord?(e.userWord.optional?"true"===t.isRight?(e.userWord.optional.correct+=1,e.userWord.optional.inRow+=1,("string"===e.userWord.difficulty&&3===e.userWord.optional.inRow||"hard"===e.userWord.difficulty&&5===e.userWord.optional.inRow)&&(e.userWord.difficulty="easy",e.userWord.optional.learnDate=(0,l.getTodayDate)())):(e.userWord.optional.wrong+=1,e.userWord.optional.inRow=0,"easy"===e.userWord.difficulty&&(e.userWord.difficulty="string",e.userWord.optional.learnDate=(0,l.getTodayDate)())):(e.userWord.optional={correct:"true"===t.isRight?1:0,wrong:"true"===t.isRight?0:1,inRow:"true"===t.isRight?1:0,notNew:!0},this.newWordCounter+=1),this.updateUserWord(e)):(e.userWord={difficulty:"string",optional:{correct:"true"===t.isRight?1:0,wrong:"true"===t.isRight?0:1,inRow:"true"===t.isRight?1:0,notNew:!0}},this.newWordCounter+=1,this.createNewUserWord(e))})),this.updateStatistics()}))}updateUserWord(t){return n(this,void 0,void 0,(function*(){yield(new o.Fetch).UPDATE_USER_WORDS_BY_ID(t._id,t.userWord)}))}createNewUserWord(t){return n(this,void 0,void 0,(function*(){yield(new o.Fetch).CREATE_USER_WORDS(t._id,t.userWord)}))}_initButtons(){return n(this,void 0,void 0,(function*(){const t=document.querySelector("#gameResultModalWindow"),e=document.querySelector("#modalResults"),s=document.querySelector("#closeWindowBtn"),n=document.querySelector("#restartGame");e.addEventListener("click",(t=>{const e=t.target.closest("button");e&&e.nextElementSibling.play()})),s.addEventListener("click",(()=>{document.exitFullscreen(),t.remove(),"book"===document.querySelector(".aside").querySelector(".active").dataset.navigation?(0,l.renderBookWithLS)():(new d.default).renderGamesPage()})),n.addEventListener("click",(()=>{t.remove(),"sprint"===this.gameName&&new r.Sprint(this.group,this.page).startGame(),"audioCall"===this.gameName&&new a.AudioCall(this.group,this.page).startGame()}))}))}render(t){const e=document.createElement("div");e.className="gameResult-modalWindow",e.id="gameResultModalWindow",e.innerHTML=this.content(),t.append(e),this._initButtons()}content(){return`\n      <div id="modalContent" class="modal__content">\n        <div class="close-window-button__wrapper">\n          <button id="closeWindowBtn" class="close-window-button">\n            <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M12.3477 10.7673L19.5075 3.67044C19.821 3.35893 19.9972 2.93644 19.9972 2.4959C19.9972 2.05536 19.821 1.63286 19.5075 1.32135C19.1939 1.00984 18.7687 0.834839 18.3253 0.834839C17.8819 0.834839 17.4566 1.00984 17.1431 1.32135L10 8.4348L2.8569 1.32135C2.54337 1.00984 2.11812 0.834839 1.67471 0.834839C1.2313 0.834839 0.806058 1.00984 0.492521 1.32135C0.178985 1.63286 0.00284159 2.05536 0.00284159 2.4959C0.00284158 2.93644 0.178985 3.35893 0.492521 3.67044L7.65227 10.7673L0.492521 17.8643C0.336458 18.018 0.212588 18.201 0.128055 18.4026C0.0435221 18.6042 0 18.8204 0 19.0388C0 19.2572 0.0435221 19.4734 0.128055 19.675C0.212588 19.8766 0.336458 20.0596 0.492521 20.2133C0.64731 20.3684 0.831467 20.4915 1.03437 20.5755C1.23727 20.6594 1.4549 20.7027 1.67471 20.7027C1.89452 20.7027 2.11215 20.6594 2.31505 20.5755C2.51796 20.4915 2.70211 20.3684 2.8569 20.2133L10 13.0999L17.1431 20.2133C17.2979 20.3684 17.482 20.4915 17.6849 20.5755C17.8878 20.6594 18.1055 20.7027 18.3253 20.7027C18.5451 20.7027 18.7627 20.6594 18.9656 20.5755C19.1685 20.4915 19.3527 20.3684 19.5075 20.2133C19.6635 20.0596 19.7874 19.8766 19.8719 19.675C19.9565 19.4734 20 19.2572 20 19.0388C20 18.8204 19.9565 18.6042 19.8719 18.4026C19.7874 18.201 19.6635 18.018 19.5075 17.8643L12.3477 10.7673Z" fill="black"/>\n            </svg>\n          </button>\n        </div>\n        <div class="modal__container">\n          <h3 class="modal__title">Результат</h3>\n          <p class="points">${this.points?`Вы набрали ${this.points} очков`:""}</p>\n          <div class="modal__accuracy">\n            <div class="accuracy__diagram animate">${this.accuracy}%</div>\n            <div class="accuracy__description">Ваша точность</div>\n          </div>\n          <div id="modalResults" class="modal__results">\n            <p>\n              Всего слов:\n              <span id="totalResultCounter" class="total-result words-count"\n                >${this.total}</span\n              >\n            </p>\n            <p>\n              Угадано слов подряд:\n              <span id="guessedInRow" class="guessed-in-row words-count"\n                >${this.inRow}</span\n              >\n            </p>\n            <div class="answers__wrapper">\n              <h4 class="">\n                Правильные ответы:\n                <span\n                  id="correctAnswersCounter"\n                  class="correct-answers words-count"\n                  >${this.correctAnswersCounter}</span\n                >\n              </h4>\n              <div class="answers__list">\n              ${this.correctAnswers.map((t=>`\n                  <div class="answer">\n                    <div class="answer-audio__wrapper">\n                      <button class="audio__btn">\n                      <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path fill-rule="evenodd" clip-rule="evenodd" d="M8.75 13.7842L3.31975 10.2622H0V4.39214H3.31975L8.75 0.870117V13.7842ZM3.5 4.97387V9.68047L8.16667 12.7076V1.94668L3.5 4.97387ZM11.7997 2.49729C13.1571 3.66485 14 5.39827 14 7.32775C14 9.25782 13.1571 10.9912 11.8008 12.1582L11.3878 11.7426C12.6338 10.6913 13.4167 9.10051 13.4167 7.32717C13.4167 5.55383 12.6338 3.96304 11.3878 2.91172L11.7997 2.49729ZM10.0911 4.21663C10.9783 4.95449 11.5354 6.07567 11.5354 7.32717C11.5354 8.57866 10.9783 9.69984 10.0911 10.4377L9.67925 10.0233C10.4557 9.39929 10.9521 8.42134 10.9521 7.32834C10.9521 6.23475 10.4557 5.2568 9.67808 4.63223L10.0911 4.21663ZM2.91667 4.97915H0.583333V9.67518H2.91667V4.97915Z" fill="black"/>\n                      </svg>\n                      </button>\n                      <audio src="https://rss21q3-rslang.herokuapp.com/${t.info.audio}"></audio>\n                    </div>\n                    <p><span class="word_en">${t.info.word}</span> - <span class="word_ru">${t.info.wordTranslate}</span></p>\n                  </div>\n                `)).join("")}\n              </div>\n            </div>\n            <div class="answers__wrapper">\n            <h4 class="">\n            Неправильные ответы:\n                <span\n                  id="wrongAnswersCounter"\n                  class="wrong-answers words-count"\n                  >${this.wrongAnswersCounter}</span\n                >\n              </h4>\n              <div class="answers__list">\n              ${this.wrongAnswers.map((t=>`\n                  <div class="answer">\n                    <div class="answer-audio__wrapper">\n                      <button class="audio__btn">\n                      <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path fill-rule="evenodd" clip-rule="evenodd" d="M8.75 13.7842L3.31975 10.2622H0V4.39214H3.31975L8.75 0.870117V13.7842ZM3.5 4.97387V9.68047L8.16667 12.7076V1.94668L3.5 4.97387ZM11.7997 2.49729C13.1571 3.66485 14 5.39827 14 7.32775C14 9.25782 13.1571 10.9912 11.8008 12.1582L11.3878 11.7426C12.6338 10.6913 13.4167 9.10051 13.4167 7.32717C13.4167 5.55383 12.6338 3.96304 11.3878 2.91172L11.7997 2.49729ZM10.0911 4.21663C10.9783 4.95449 11.5354 6.07567 11.5354 7.32717C11.5354 8.57866 10.9783 9.69984 10.0911 10.4377L9.67925 10.0233C10.4557 9.39929 10.9521 8.42134 10.9521 7.32834C10.9521 6.23475 10.4557 5.2568 9.67808 4.63223L10.0911 4.21663ZM2.91667 4.97915H0.583333V9.67518H2.91667V4.97915Z" fill="black"/>\n                      </svg>\n                      </button>\n                      <audio src="https://rss21q3-rslang.herokuapp.com/${t.info.audio}"></audio>\n                    </div>\n                    <p><span class="word_en">${t.info.word}</span> - <span class="word_ru">${t.info.wordTranslate}</span></p>\n                  </div>\n                `)).join("")}\n              </div>\n            </div>\n          </div>\n          <div class="restart-game-btn__wrapper">\n            <button id="restartGame" class="restart-game">Начать заново</button>\n          </div>\n        </div>\n      </div>\n    `}}},613:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),s(482),e.default=function(t){const e=document.createElement("footer");e.className="footer",e.innerHTML='\n    <a href="https://rs.school/js/" target="_blink" class="rsschool"></a>\n    <div class="team">\n        <a href="https://github.com/Prizzz" target="_blink">Prizzz</a>\n        <a href="https://github.com/AvlasenkoPetr" target="_blink">AvlasenkoPetr</a>\n        <a href="https://github.com/rakyt4gin" target="_blink">rakyt4gin</a>\n    </div>\n    <div class="year">2022</div>\n    ',t.append(e)}},869:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Spinner=void 0,s(974),e.Spinner=class{constructor(){this.MAIN__WRAPPER=document.querySelector(".main__wrapper"),this.FULL_DASH_ARRAY=283,this.TIME_LIMIT=5,this.timePassed=0,this.timeLeft=this.TIME_LIMIT}renderTimer(){this.MAIN__WRAPPER.innerHTML=`\n    <div class="wrapper-spinner">\n    <div class="base-timer">\n      <svg class="base-timer__svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">\n        <g class="base-timer__circle">\n          <circle class="base-timer__path-elapsed" cx="50" cy="50" r="45"></circle>\n          <path\n            id="base-timer-path-remaining"\n            stroke-dasharray="283"\n            class="base-timer__path-remaining purple"\n            d="\n              M 50, 50\n              m -45, 0\n              a 45,45 0 1,0 90,0\n              a 45,45 0 1,0 -90,0\n            "\n          ></path>\n        </g>\n      </svg>\n      <span id="base-timer-label" class="base-timer__label">${this.timeLeft}</span>\n    </div>\n    </div>\n    `}startTimer(t){this.renderTimer();const e=document.getElementById("base-timer-label"),s=setInterval((()=>{this.timePassed=this.timePassed+=1,this.timeLeft=this.TIME_LIMIT-this.timePassed,e.innerHTML=String(this.timeLeft),this.setCircleDasharray(),0===this.timeLeft&&(clearInterval(s),t())}),1e3)}calculateTimeFraction(){const t=this.timeLeft/this.TIME_LIMIT;return t-1/this.TIME_LIMIT*(1-t)}setCircleDasharray(){const t=document.getElementById("base-timer-path-remaining"),e=Number((this.calculateTimeFraction()*this.FULL_DASH_ARRAY).toFixed(0));e<0&&(t.style.opacity="0");const s=`${e} 283`;t.setAttribute("stroke-dasharray",s)}}},73:function(t,e,s){var n=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(i,r){function a(t){try{d(n.next(t))}catch(t){r(t)}}function o(t){try{d(n.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,o)}d((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.BookPage=void 0;const r=s(352),a=s(718),o=i(s(613)),d=s(869),l=s(179),c=s(428);function u(){const t=document.getElementById("counter"),e=null==t?void 0:t.value;localStorage.setItem("lastBookPage",e),document.querySelectorAll(".book-page__level-container_button").forEach(((t,e)=>{t.classList.contains("active")&&localStorage.setItem("lastBookLevel",String(e))}))}s(817),e.BookPage=class{constructor(t){this.processClick=t=>n(this,void 0,void 0,(function*(){if(!(t.target instanceof HTMLElement))return;const e=t.target;if(!e.dataset.book||e.classList.contains("disabled"))return;const s=e.dataset.book,n=document.getElementById("counter"),i=n?String(Number(null==n?void 0:n.value)-1):"",r=new d.Spinner;switch(s){case"audiocall":return u(),void r.startTimer((()=>{new l.AudioCall(this.LEVEL,i).startGame()}));case"sprint":return u(),void r.startTimer((()=>{new c.Sprint(this.LEVEL,i).startGame()}));case"prev":return void this.toPrevPage(e);case"next":return void this.toNextPage(e);case"0":case"1":case"2":case"3":case"4":case"5":case"6":if(e.classList.contains("active"))return;return this.LEVEL=s,void this.renderBookPage()}})),this.processWordClick=(t,e)=>n(this,void 0,void 0,(function*(){if(!(t.target instanceof HTMLElement))return;const s=t.target;if(!s.dataset.word||s.classList.contains("disabled"))return;const n=s.dataset.word;switch(n){case"play":if(s.classList.contains("playing"))return s.classList.remove("playing"),void this.AUDIO.pause();const t=document.querySelector(".playing");return t&&(t.classList.remove("playing"),this.AUDIO.pause()),s.classList.add("playing"),void this.playAudioChain(s,e.audio,e.audioMeaning,e.audioExample);case"hard":case"easy":const i=s.closest(".words-container__item");if(!i||i.getAttribute("disabled"))return;i.setAttribute("disabled","true");const r=e._id?e._id:e.id,a=yield this.FETCH.GET_STATISTICS();delete a.id;const o=i.classList.contains("easy")&&"easy"===n,d=i.classList.contains("easy")&&"hard"===n,l=i.classList.length<3&&"easy"===n,c=i.classList.contains("hard")&&"easy"===n;if(o||d?a.learnedWords-=1:(l||c)&&(a.learnedWords+=1),yield this.FETCH.UPDATE_STATISTICS(a),i.classList.contains(`${n}`))return yield this.FETCH.UPDATE_USER_WORDS_BY_ID(r,{difficulty:"string"}),"6"===this.LEVEL?(i.remove(),void i.removeAttribute("disabled")):(i.classList.remove(`${n}`),this.isPageLearned(),void i.removeAttribute("disabled"));if(i.classList.contains("easy")||i.classList.contains("hard"))return yield this.FETCH.UPDATE_USER_WORDS_BY_ID(r,{difficulty:`${n}`}),"6"===this.LEVEL?(i.remove(),void i.removeAttribute("disabled")):(i.classList.remove(`${i.classList[i.classList.length-1]}`),i.classList.add(`${n}`),this.isPageLearned(),void i.removeAttribute("disabled"));try{yield this.FETCH.GET_USER_WORDS_BY_ID(e.id),yield this.FETCH.UPDATE_USER_WORDS_BY_ID(e.id,{difficulty:`${n}`})}catch(t){this.FETCH.CREATE_USER_WORDS(e.id,{difficulty:`${n}`})}return i.classList.add(`${n}`),this.isPageLearned(),void i.removeAttribute("disabled")}})),this.renderBookPage=t=>n(this,void 0,void 0,(function*(){this.MAIN_WRAPPER.innerHTML="",this.BOOK_PAGE.innerHTML=this.bookMenuContent(t),this.BOOK_PAGE.append(this.WORDS_CONTAINER),(0,o.default)(this.BOOK_PAGE),this.MAIN_WRAPPER.append(this.BOOK_PAGE),this.setActiveLevel(),this.toggleDisabled(".book-page__pagination-container_button"),yield this.renderWordsContainer(),this.toggleDisabled(".book-page__pagination-container_button")})),this.renderWordsContainer=()=>n(this,void 0,void 0,(function*(){this.WORDS_CONTAINER.innerHTML="";const t=document.getElementById("counter"),e=String(Number(null==t?void 0:t.value)-1),s=yield this.getWordsToRender(e),i=yield this.getUserWords();for(let t of s){const e=document.createElement("div");e.className=`words-container__item ${this.LEVEL_NAMES[Number(this.LEVEL)]}`;const s=null==i?void 0:i.find((e=>e.wordId===t.id));s&&"string"!==s.difficulty&&e.classList.add(`${s.difficulty}`),e.innerHTML=`${this.wordItemContent(t,s)}`,e.addEventListener("click",(e=>n(this,void 0,void 0,(function*(){return this.processWordClick(e,t)})))),this.WORDS_CONTAINER.append(e)}this.isPageLearned()})),this.getWordsToRender=t=>n(this,void 0,void 0,(function*(){let e;return e="6"!==this.LEVEL?yield this.FETCH.GET_WORDS(this.LEVEL,t):(yield this.FETCH.GET_AGGREGATED_WORDS({filter:'{"userWord.difficulty":"hard"}'}))[0].paginatedResults,e})),this.getUserWords=()=>n(this,void 0,void 0,(function*(){let t;return(0,a.isUserExists)()&&(t=yield this.FETCH.GET_USER_WORDS()),t})),this.toggleDisabled=(t,e)=>{const s=document.querySelectorAll(`${t}`);"add"===e?s.forEach((t=>t.classList.add("disabled"))):"remove"===e?s.forEach((t=>t.classList.remove("disabled"))):s.forEach((t=>t.classList.toggle("disabled")))},this.setActiveLevel=()=>{var t;const e=document.querySelector(`[data-book="${this.LEVEL}"]`),s=null===(t=null==e?void 0:e.parentElement)||void 0===t?void 0:t.querySelector(".active");s&&s.classList.remove("active"),null==e||e.classList.add("active")},this.isPageLearned=()=>{const t=this.WORDS_CONTAINER.querySelectorAll(".easy"),e=this.WORDS_CONTAINER.querySelectorAll(".hard"),s=this.WORDS_CONTAINER.querySelectorAll(".words-container__item");t.length>0&&t.length+e.length===s.length?(this.BOOK_PAGE.classList.add("learned"),this.toggleDisabled(".book-page__games-menu_button","add")):(this.BOOK_PAGE.classList.remove("learned"),this.toggleDisabled(".book-page__games-menu_button","remove"))},this.playAudioChain=(t,...e)=>{if(0===e.length)return this.AUDIO.pause(),void t.classList.remove("playing");this.AUDIO.src=`https://rss21q3-rslang.herokuapp.com/${e[0]}`,this.AUDIO.play(),this.AUDIO.onended=()=>this.playAudioChain(t,...e.slice(1))},this.bookMenuContent=t=>` \n    <div class="book-page__menu-wrapper">\n      <h2>Электронный учебник</h2>\n\n      <div class="book-page__games-menu">\n        <button class="book-page__games-menu_button" data-book="sprint">Спринт</button>\n        <button class="book-page__games-menu_button" data-book="audiocall">Аудиовызов</button>\n      </div>\n\n      <div class="book-page__menu-row">\n\n        ${"6"!==this.LEVEL?this.paginationBlockContent(t):"<div></div>"}\n\n        <div class="book-page__level-container">\n          <button class="book-page__level-container_button" data-book="0">A1</button>\n          <button class="book-page__level-container_button" data-book="1">A2</button>\n          <button class="book-page__level-container_button" data-book="2">B1</button>\n          <button class="book-page__level-container_button" data-book="3">B2</button>\n          <button class="book-page__level-container_button" data-book="4">C1</button>\n          <button class="book-page__level-container_button" data-book="5">C2</button>\n          ${(0,a.isUserExists)()?'<button class="book-page__level-container_button" data-book="6">H</button>':""}\n        </div>\n\n      </div>\n    </div>\n    `,this.paginationBlockContent=t=>`\n    <div class="book-page__pagination-container">\n      <button class="book-page__pagination-container_button" data-book="prev"></button>\n      <input type="number" min="1" max="30" value="${t||1}" class="book-page__pagination-container_counter" id="counter" readonly></input>\n      <button class="book-page__pagination-container_button" data-book="next"></button>\n    </div>\n    `,this.wordControllsContent=t=>{var e,s;return`\n    <div class="difficulty-cotrolls__block">\n      <button class="difficulty-cotrolls__button" data-word="hard" title="Пометить слово как сложное"></button>\n      <button class="difficulty-cotrolls__button" data-word="easy" title="Пометить слово как изученное"></button>\n    </div>\n\n    <div class="answers-counter__block">\n      <input class="answers-counter__wrong" type="number" value="${(null===(e=null==t?void 0:t.optional)||void 0===e?void 0:e.wrong)||0}" readonly>\n      <input class="answers-counter__correct" type="number" value="${(null===(s=null==t?void 0:t.optional)||void 0===s?void 0:s.correct)||0}" readonly>\n    </div>\n    `},this.wordItemContent=(t,e)=>`\n    <div class="words-container__item_image-block">\n      <img src="https://rss21q3-rslang.herokuapp.com/${t.image}">\n    </div>\n\n    <div class="words-container__item_info-block">\n      <div class="info-block_title">\n        ${t.word[0].toUpperCase()}${t.word.slice(1)} -\n        ${t.transcription} - \n        ${t.wordTranslate}\n      </div>\n\n      <div class="info-block_description">\n        ${t.textMeaning}<br>${t.textMeaningTranslate}\n      </div>\n\n      <div class="info-block_description">\n        ${t.textExample}<br>${t.textExampleTranslate}\n      </div>\n    </div>\n\n    <div class="words-container__item_controlls-block">\n      <button class="sound-button" data-word="play"></button>\n      ${(0,a.isUserExists)()?this.wordControllsContent(e):""}\n    </div> \n    `,this.MAIN_WRAPPER=document.querySelector(".main__wrapper"),this.BOOK_PAGE=document.createElement("main"),this.BOOK_PAGE.className="book-page page",this.BOOK_PAGE.addEventListener("click",this.processClick),this.WORDS_CONTAINER=document.createElement("div"),this.WORDS_CONTAINER.className="words-container",this.LEVEL=t,this.LEVEL_NAMES=["a1","a2","b1","b2","c1","c2","hard"],this.AUDIO=new Audio,this.FETCH=new r.Fetch}toNextPage(t){return n(this,void 0,void 0,(function*(){const e=t.previousElementSibling;"30"!==e.value&&(this.toggleDisabled(".book-page__pagination-container_button"),e.stepUp(),yield this.renderWordsContainer(),this.toggleDisabled(".book-page__pagination-container_button"))}))}toPrevPage(t){return n(this,void 0,void 0,(function*(){const e=t.nextElementSibling;"1"!==e.value&&(this.toggleDisabled(".book-page__pagination-container_button"),e.stepDown(),yield this.renderWordsContainer(),this.toggleDisabled(".book-page__pagination-container_button"))}))}},window.addEventListener("beforeunload",(()=>{document.querySelector(".book-page")?u():(localStorage.removeItem("lastBookLevel"),localStorage.removeItem("lastBookPage"))}))},568:function(t,e,s){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=n(s(613)),r=s(438);s(448),e.default=class{constructor(){this.renderErrorPage=()=>{this.MAIN_WRAPPER.innerHTML="",this.ERROR_PAGE.innerHTML='\n    <h1>Упс...</h1>\n    <h2>Похоже этот раздел вам недоступен</h2>\n    <h3>Попробуйте <span data-error="login">авторизироваться</span> и проверьте еще раз</h3>\n    ',this.ERROR_PAGE.addEventListener("click",this.processClick),this.MAIN_WRAPPER.append(this.ERROR_PAGE),(0,i.default)(this.MAIN_WRAPPER)},this.processClick=t=>{if(!(t.target instanceof HTMLElement))return;const e=t.target;if(!e.dataset.error)return;const s=document.querySelector(".aside"),n=null==s?void 0:s.querySelector(".active");null==n||n.classList.remove("active"),"login"!==e.dataset.error||((null==s?void 0:s.querySelector(`[data-navigation=${e.dataset.error}]`)).classList.add("active"),(new r.LoginPage).renderLoginPage())},this.MAIN_WRAPPER=document.querySelector(".main__wrapper"),this.ERROR_PAGE=document.createElement("main"),this.ERROR_PAGE.className="error-page page"}}},910:function(t,e,s){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=n(s(315)),r=n(s(519)),a=n(s(613)),o=n(s(31));s(896),e.default=class{constructor(){this.processClick=t=>{if(!(t.target instanceof HTMLElement))return;const e=t.target.closest("[data-games]");if(!e)return;const s=e.dataset.games;!s||"audiocall"!==s&&"sprint"!==s||new o.default(s).renderLevelPage()},this.renderGamesPage=()=>{this.MAIN_WRAPPER.innerHTML="",this.GAMES_PAGE.innerHTML=this.gamesPageContent(),this.MAIN_WRAPPER.append(this.GAMES_PAGE),(0,a.default)(this.MAIN_WRAPPER)},this.gamesPageContent=()=>`\n      <div class="games-page__container">\n\n        <div class="games-card" data-games="sprint">\n          <img src="${i.default}">\n          <h2>Спринт</h2>\n          <p>Угадайте как можно больше слов за отведенное время!</p>\n        </div>\n\n        <div class="games-card" data-games="audiocall">\n          <img src="${r.default}">\n          <h2>Аудиовызов</h2>\n          <p>Определите правильное слово по его произношению!</p>\n        </div>\n\n      </div>\n      `,this.MAIN_WRAPPER=document.querySelector(".main__wrapper"),this.GAMES_PAGE=document.createElement("main"),this.GAMES_PAGE.className="games-page page",this.GAMES_PAGE.addEventListener("click",this.processClick)}}},179:function(t,e,s){var n=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(i,r){function a(t){try{d(n.next(t))}catch(t){r(t)}}function o(t){try{d(n.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,o)}d((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.AudioCall=void 0;const i=s(718),r=s(897);s(863);const a=s(352),o=s(809);let d=20;var l;!function(t){t.SET_GROUP_VALUE="SET-GROUP-VALUE",t.SET_DATA="SET-DATA",t.SET_NEXT_PAGE="SET-NEXT-PAGE",t.SHOW_ANSWER="SHOW-ANSWER",t.BACK_TO_START_PAGE="BACK_TO_START_PAGE",t.SET_ANSWERS="SET-ANSWERS",t.SET_WORD="SET-WORD",t.SET_DISABLED_BUTTONS="SET-DISABLED-BUTTONS",t.SET_FULL_SCREEN="SET-FULL-SCREEN"}(l||(l={})),e.AudioCall=class{constructor(t,e){this.state={data:null,group:"0",page:"0",currentPage:0,isAnswerHide:!0,currentAnswers:[],words:[],disabledButtons:!1,fullScreen:!1,inRow:0},this.gamePage=new r.GamePage,this.keyUp=t=>n(this,void 0,void 0,(function*(){const e=document.querySelector("#answersWrapper").querySelectorAll("button");if(!this.state.disabledButtons&&("1"==t.key||"2"==t.key||"3"==t.key||"4"==t.key)){const s=e[+t.key-1];s.hasAttribute("isRight")&&("true"===s.getAttribute("isRight")?(this.state.inRow+=1,s.classList.add("right-answer"),this.setWordActionCreator(this.state.data[this.state.currentPage],"true")):"false"===s.getAttribute("isRight")&&(s.classList.add("bad-answer"),this.state.inRow=0,this.setWordActionCreator(this.state.data[this.state.currentPage],"false"),s.closest(".answers__wrapper").querySelector('[isRight="true"]').classList.add("right-answer")))}" "==t.key&&(this.state.isAnswerHide?this.showAnswer():this.setNextPageActionCreator())})),this.group=t,this.state.group=t,"6"===t&&(e||(this.page="0  ",this.state.page="0")),e&&(this.page=e,this.state.page=e),window.addEventListener("removeEventListeners",this.remove.bind(this)),document.body.addEventListener("keyup",this.keyUp)}setFullScreen(t){return n(this,void 0,void 0,(function*(){t.currentTarget.blur(),this.setFullScreenActionCreator(),this.activateFullScreen()}))}activateFullScreen(){var t;return n(this,void 0,void 0,(function*(){const e=document.querySelector(".main__wrapper");(null===(t=document.fullscreenElement)||void 0===t?void 0:t.classList.contains("main__wrapper"))?document.exitFullscreen():e.requestFullscreen()}))}startGame(){return n(this,void 0,void 0,(function*(){let t,e;this.page?t=this.page:(t=""+(0,i.setRandomNumber)(30),this.state.page=t);try{let s;if("6"===this.group)s=yield(new a.Fetch).GET_AGGREGATED_WORDS({wordsPerPage:"3600",page:t,filter:'{"userWord.difficulty":"hard"}'}),e=s[0].paginatedResults;else{for(s=yield(new a.Fetch).GET_AGGREGATED_WORDS({wordsPerPage:"20",filter:`{"$and":[{"group": ${this.group}, "page": ${t}}]}`}),s[0].paginatedResults=s[0].paginatedResults.filter((t=>{var e;return"easy"!==(null===(e=t.userWord)||void 0===e?void 0:e.difficulty)}));s[0].paginatedResults.length<20&&(t=""+(+t-1),!(+t<0));){const e=yield(new a.Fetch).GET_AGGREGATED_WORDS({wordsPerPage:"20",filter:`{"$and":[{"group": ${this.group}, "page": ${t}}]}`});e[0].paginatedResults=e[0].paginatedResults.filter((t=>{var e;return"easy"!==(null===(e=t.userWord)||void 0===e?void 0:e.difficulty)})),s[0].paginatedResults.push(...e[0].paginatedResults)}e=s[0].paginatedResults.slice(0,20)}e.forEach((t=>{t.id=t._id,delete t._id}))}catch(s){e=yield(new a.Fetch).GET_WORDS(this.group,t)}d=e.length,this.gamePage.render(),this.setDataActionCreator(e),this.gamePage.renderWords(this.state),this.setAnswers(e,this.state.currentPage),this._initGamePage()}))}_initGamePage(){const t=document.querySelector("#nextPageButton"),e=document.querySelector("#dontKnowButton"),s=document.querySelector("#answersWrapper");document.querySelector("#fullscreenButton").addEventListener("click",this.setFullScreen.bind(this)),s.addEventListener("click",this.handleClickShowAnswers.bind(this)),t.addEventListener("click",this.setNextPageActionCreator.bind(this)),e.addEventListener("click",this.showAnswer.bind(this)),this._initPlay()}remove(){document.body.removeEventListener("keyup",this.keyUp,!1)}showAnswer(){let t={info:this.state.data[this.state.currentPage],isRight:"false"};this.state.words.push(t),this.showAnswerActionCreator()}_initPlay(){document.querySelectorAll(".audioCall__audio-button").forEach((t=>{t.addEventListener("click",this.playAudio.bind(this))}))}playAudio(t){t.target.closest(".audioCall__audio-button").nextElementSibling.play()}handleClickShowAnswers(t){if(!this.state.disabledButtons){const e=t.target;e.hasAttribute("isRight")&&("true"===e.getAttribute("isRight")?(this.state.inRow+=1,e.classList.add("right-answer"),this.setWordActionCreator(this.state.data[this.state.currentPage],"true")):"false"===e.getAttribute("isRight")&&(e.classList.add("bad-answer"),this.state.inRow=0,this.setWordActionCreator(this.state.data[this.state.currentPage],"false"),e.closest(".answers__wrapper").querySelector('[isRight="true"]').classList.add("right-answer")))}}setAnswers(t,e){const s=[...[...t].filter((s=>s.id!==t[e].id)).sort((()=>Math.random()-.5)).slice(0,3)];s.push(t[e]),this.setAnswersActionCreator(s),this.gamePage.renderAnswers(this.state.currentAnswers,this.state.data[this.state.currentPage])}setFullScreenActionCreator(){const t={type:l.SET_FULL_SCREEN};this.setState(t)}backToStartPageActionCreator(){const t={type:l.BACK_TO_START_PAGE};this.setState(t)}setNextPageActionCreator(){const t={type:l.SET_NEXT_PAGE,currentPage:this.state.currentPage+=1};if(!this.state.isAnswerHide)if(this.state.currentPage<d)this.setState(t),this.gamePage.renderWords(this.state),this.setAnswers(this.state.data,this.state.currentPage),this.setDisabledButtons(!1),this._initPlay();else{const t=document.querySelector("#audioCallMainElement"),e={group:this.state.group,page:this.state.page,total:this.state.data.length,inRow:this.state.inRow,answersArr:this.state.words,gameName:"audioCall"};this.remove(),new o.GameResult(e).render(t)}}setDataActionCreator(t){const e={type:l.SET_DATA,data:t.sort((()=>Math.random()-.5))};this.setState(e)}setGroupValueActionCreator(t){const e={type:l.SET_GROUP_VALUE,group:t.target.value};this.setState(e)}showAnswerActionCreator(){const t={type:l.SHOW_ANSWER};this.setState(t),this.showRightAnswer(),this.gamePage.renderWords(this.state),this._initPlay()}showRightAnswer(){document.querySelector("#answersWrapper").querySelector('[isright="true"]').classList.add("right-answer")}setAnswersActionCreator(t){const e={type:l.SET_ANSWERS,currentAnswers:t.sort((()=>Math.random()-.5))};this.setState(e)}setWordActionCreator(t,e){const s={type:l.SET_WORD,word:{info:t,isRight:e}};this.setState(s),this.showAnswerActionCreator(),this.setDisabledButtons(!0)}setDisabledButtons(t){const e={type:l.SET_DISABLED_BUTTONS,disabledButtons:t};this.setState(e)}setState(t){switch(t.type){case l.SET_GROUP_VALUE:this.state=Object.assign(Object.assign({},this.state),{group:t.group});break;case l.SET_DATA:this.state=Object.assign(Object.assign({},this.state),{data:t.data});break;case l.SET_NEXT_PAGE:this.state=Object.assign(Object.assign({},this.state),{currentPage:t.currentPage,isAnswerHide:!0});break;case l.SHOW_ANSWER:this.state=Object.assign(Object.assign({},this.state),{isAnswerHide:!1});break;case l.BACK_TO_START_PAGE:this.state=Object.assign(Object.assign({},this.state),{isAnswerHide:!0,currentPage:19,currentAnswers:[],words:[],disabledButtons:!1});break;case l.SET_ANSWERS:this.state=Object.assign(Object.assign({},this.state),{currentAnswers:t.currentAnswers});break;case l.SET_WORD:this.state=Object.assign(Object.assign({},this.state),{words:[...this.state.words,t.word]});break;case l.SET_DISABLED_BUTTONS:this.state=Object.assign(Object.assign({},this.state),{disabledButtons:t.disabledButtons});break;case l.SET_FULL_SCREEN:this.state=Object.assign(Object.assign({},this.state),{fullScreen:!this.state.fullScreen})}}}},897:function(t,e,s){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GamePage=void 0;const i=n(s(285)),r=n(s(814));e.GamePage=class{constructor(){this.MAIN_WRAPPER=document.querySelector(".main__wrapper")}renderWords(t){const e=document.querySelector("#wordWrapper"),s=document.querySelector("#audioWrapper"),n=document.querySelector("#nextPageButton"),i=t.data,r=t.currentPage;this.renderCurrentPage(r),this.renderAllPages(i.length),s.innerHTML=`<img class="answer-img" src="https://rss21q3-rslang.herokuapp.com/${i[r].image}">`,e.innerHTML=this.pageContent(i[r]);const a=document.querySelector("#hiddenWord");!1===t.isAnswerHide?(a.classList.add("visible"),n.classList.remove("hide"),n.nextElementSibling.classList.add("hide")):!0===t.isAnswerHide&&(a.classList.remove("visible"),n.classList.add("hide"),n.nextElementSibling.classList.remove("hide"))}renderCurrentPage(t){document.querySelector("#audioCallCurrentPage").innerHTML=`${t+=1}`}renderAllPages(t){document.querySelector("#audioCallAllPages").innerHTML=`${t}`}renderAnswers(t,e){const s=document.querySelector("#answersWrapper");document.querySelector("#audioWrapper").innerHTML=this.audioContent(e,!0),s.innerHTML="",t.forEach((t=>{const n=document.createElement("button");t.id===e.id?n.setAttribute("isRight","true"):n.setAttribute("isRight","false"),n.textContent=t.wordTranslate,n.setAttribute("id",t.id),n.classList.add("answer"),n.classList.add("btn"),s.append(n)}))}render(){this.MAIN_WRAPPER.innerHTML=this.gamePageContent()}resultsContent(t,e){return`\n    <div class="overlay">\n      <div class="modal-window__wrapper">\n        <h2 class="modal-window__title>Результаты</h2>\n        <div class="modal-window__content">\n          <h3 class="rightContent__title">Я знаю <span id="rightAnswersCounter" class="right-answers_counter">${t.length}</span></h3>        \n          <div id="rightContentBody" class="rightContent__body">\n          ${t.map((t=>`\n      <div>${t.info.word} - ${t.info.wordTranslate}</div>\n      `)).join("")}\n          </div>\n          <h3 class="worthContent__title">Я не знаю <span id="worthAnswersCounter" class="worth-answers_counter">${e.length}</span></h3>        \n          <div id="worthContentBody" class="worthContent__body">\n          ${e.map((t=>`\n            <div>${t.info.word} - ${t.info.wordTranslate}</div>\n            `)).join("")}</div>\n          <button id="closeModalWindow" class="close-modal-window">Закрыть</button>\n        </div>\n      </div>\n    </div>\n    `}audioContent(t,e){return`\n    <button class="audioCall__audio-button">\n      <span class="internal-img">\n        <img src="${r.default}" alt="audio-button">\n      </span>\n    </button>\n    <audio ${e?"autoplay":""} src="https://rss21q3-rslang.herokuapp.com/${t.audio}"></audio>\n    `}pageContent(t){return`\n      <div id="hiddenWord" class="word">\n        <p>${t.word}</p>\n        ${this.audioContent(t,!1)}\n      </div>\n    `}gamePageContent(){return`\n      <main id="audioCallMainElement" class="audioCall-page page">\n        <div class="container">\n          <div class="audioCall__header">\n            <div class="current-answer"><span id="audioCallCurrentPage"></span> / <span id="audioCallAllPages"></span></div>\n            <div class="fullScreen-btn__wrapper">\n              <button id="fullscreenButton" class="fullScreen-btn">\n                <img src="${i.default}">\n              </button>\n            </div>\n          </div>  \n          <div class="audio__wrapper">\n            <div class="audioButton__wrapper" id="audioWrapper"></div>\n            <div class="word__wrapper" id="wordWrapper"></div>\n          </div>\n          <div class="answers__wrapper" id="answersWrapper"></div>\n          <div class="btn__wrapper">\n            <button class="btn next-page__btn hide" id="nextPageButton">Далее</button>\n            <button class="btn dont-know__button" id="dontKnowButton">Не знаю</button>\n          </div>\n        </div>\n      </main>\n    `}}},428:function(t,e,s){var n=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(i,r){function a(t){try{d(n.next(t))}catch(t){r(t)}}function o(t){try{d(n.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,o)}d((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Sprint=void 0;const r=i(s(421)),a=i(s(78)),o=i(s(566)),d=i(s(846));s(155);const l=s(718),c=s(352),u=s(809),h=new c.Fetch;e.Sprint=class{constructor(t,e){this.rightAnswer=()=>{this.updatePointsInfo(!0),this.audio.src=o.default,this.audio.play(),void 0===this.rightAnswersArr.find((t=>t.info===this.currentWord))&&this.rightAnswersArr.push({info:this.currentWord,isRight:"true"})},this.wrongAnswer=()=>{this.updatePointsInfo(!1),this.audio.src=d.default,this.audio.play(),void 0===this.mistakesArr.find((t=>t.info===this.currentWord))&&this.mistakesArr.push({info:this.currentWord,isRight:"false"})},this.right=()=>{var t;const e=null===(t=this.words.find((t=>t.word===this.word)))||void 0===t?void 0:t.wordTranslate;this.translate===e?this.rightAnswer():this.wrongAnswer(),this.round()},this.wrong=()=>{var t;const e=null===(t=this.words.find((t=>t.word===this.word)))||void 0===t?void 0:t.wordTranslate;this.translate!==e?this.rightAnswer():this.wrongAnswer(),this.round()},this.keyUp=t=>n(this,void 0,void 0,(function*(){"ArrowLeft"===t.key&&this.right(),"ArrowRight"===t.key&&this.wrong()})),this.MAIN_WRAPPER=document.querySelector(".main__wrapper"),this.auth="1"!==(0,l.getUserInfo)().token,this.sprintStatistic={newWords:0},this.group=t,"6"===t?(this.fromBook=!0,e||(this.page="0")):e?(this.page=e,this.fromBook=!0):(this.page=String((0,l.setRandomNumber)(29)),this.fromBook=!1),this.TIMER_COUNT=60,this.words=[],this.points=0,this.countPoints=10,this.progress=0,this.inrow=0,this.maxrow=0,this.answers=0,this.rightAnswers=0,this.mistakes=0,this.rightAnswersArr=[],this.mistakesArr=[],this.audio=new Audio,window.addEventListener("removeEventListeners",this.remove.bind(this)),document.body.addEventListener("keyup",this.keyUp)}remove(){document.body.removeEventListener("keyup",this.keyUp,!1)}startGame(){return n(this,void 0,void 0,(function*(){let t,e=this.page;if(this.auth){let s;if("6"===this.group)s=yield h.GET_AGGREGATED_WORDS({wordsPerPage:"3600",page:e,filter:'{"userWord.difficulty":"hard"}'}),t=s[0].paginatedResults;else{for(s=yield h.GET_AGGREGATED_WORDS({wordsPerPage:"20",filter:`{"$and":[{"group": ${this.group}, "page": ${e}}]}`}),s[0].paginatedResults=s[0].paginatedResults.filter((t=>{var e;return"easy"!==(null===(e=t.userWord)||void 0===e?void 0:e.difficulty)}));s[0].paginatedResults.length<20&&(e=""+(+e-1),!(+e<0));){const t=yield h.GET_AGGREGATED_WORDS({wordsPerPage:"20",filter:`{"$and":[{"group": ${this.group}, "page": ${e}}]}`});t[0].paginatedResults=t[0].paginatedResults.filter((t=>{var e;return"easy"!==(null===(e=t.userWord)||void 0===e?void 0:e.difficulty)})),s[0].paginatedResults.push(...t[0].paginatedResults)}t=s[0].paginatedResults.slice(0,20)}t.forEach((t=>{t.id=t._id,delete t._id}))}else t=yield h.GET_WORDS(this.group,e);this.words=t,this.words.forEach((t=>{t.userWord||(t.userWord={difficulty:"string"}),t.userWord.optional||(t.userWord.optional={correct:0,wrong:0,inRow:0})})),this.MAIN_WRAPPER.innerHTML="",this.game()}))}timer(){const t=document.querySelector(".timer"),e=setInterval((()=>{this.TIMER_COUNT-=1,t.innerHTML=String(this.TIMER_COUNT),0===this.TIMER_COUNT&&(clearInterval(e),this.stopGame())}),1e3)}round(){const t=document.querySelector(".word"),e=document.querySelector(".translate-word");let s,n,i;if(this.words.length<20){void 0===this._words&&(this._words=this.words.slice());const t=(0,l.setRandomNumber)(this._words.length);0===this._words.length?(this.TIMER_COUNT=0,this.stopGame()):(s=this._words[t],n=s.word,i=this._words[(0,l.setRandomNumber)(this._words.length)].wordTranslate,this._words.splice(t,1))}else{const t=(0,l.setRandomNumber)(this.words.length);s=this.words[t],n=s.word,i=this.words[(0,l.setRandomNumber)(this.words.length)].wordTranslate,Boolean((0,l.setRandomNumber)(2))&&(n=s.word,i=s.wordTranslate)}this.currentWord=s,t.innerHTML=n,e.innerHTML=i,this.word=t.innerText,this.translate=e.innerText}fullscreen(){document.querySelector(".fullscreen-btn").addEventListener("click",(()=>{var t;(null===(t=document.fullscreenElement)||void 0===t?void 0:t.classList.contains("main__wrapper"))?document.exitFullscreen():this.MAIN_WRAPPER.requestFullscreen()}))}volume(){const t=document.querySelector(".audio-btn");t.addEventListener("click",(()=>{t.classList.contains("active")?(t.classList.remove("active"),this.audio.muted=!1,t.src=r.default):(t.classList.add("active"),this.audio.muted=!0,t.src=a.default)}))}updatePointsInfo(t){this.answers+=1;const e=document.querySelector(".points"),s=document.querySelector(".count-points"),n=document.querySelectorAll(".progress-item"),i=this.currentWord.userWord;if(void 0===i.optional.notNew&&(this.sprintStatistic.newWords+=1,i.optional.notNew=!0),t){this.points+=this.countPoints,this.progress+=1,this.rightAnswers+=1,this.inrow+=1,i.optional.correct+=1,i.optional.inRow+=1,("string"===i.difficulty&&3===i.optional.inRow||"hard"===i.difficulty&&5===i.optional.inRow)&&(i.difficulty="easy",i.optional.learnDate=(0,l.getTodayDate)()),4===this.progress&&(this.progress=0,80!==this.countPoints&&(this.countPoints*=2,n.forEach((t=>{t.classList.remove("complete")})),s.style.animation="progress 1s linear forwards",s.addEventListener("animationend",(()=>{s.style.animation=""})))),e.innerHTML=String(this.points),s.innerHTML=`+${this.countPoints} points`;for(let t=0;t<this.progress;t+=1)n[t].classList.add("complete")}else this.progress=0,this.mistakes+=1,this.inrow=0,i.optional.wrong+=1,i.optional.inRow=0,"easy"===i.difficulty&&(i.difficulty="string",i.optional.learnDate=(0,l.getTodayDate)()),10!==this.countPoints&&(this.countPoints=10,s.style.animation="progress 1s linear forwards",s.addEventListener("animationend",(()=>{s.style.animation=""}))),s.innerHTML=`+${this.countPoints} points`,n.forEach((t=>{t.classList.remove("complete")}));this.inrow>this.maxrow&&(this.maxrow=this.inrow)}renderGame(){this.MAIN_WRAPPER.insertAdjacentHTML("beforeend",`\n      <div class="sprint-wrapper">\n      <div class="game-buttons">\n        <div class="fullscreen-btn"></div>\n        <img src="${r.default}" class="audio-btn"></img>\n      </div>\n      <div class="game-area">\n        <span class="timer">${this.TIMER_COUNT}</span>\n        <div class="main-window">\n          <span class="points">0</span>\n          <span class="count-points">+10 points</span>\n          <div class="progress">\n            <div class="progress-item"></div>\n            <div class="progress-item"></div>\n            <div class="progress-item"></div>\n          </div>\n          <span class="word"></span>\n          <span class="translate-word"></span>\n          <div class="main-buttons">\n            <button class="right btn">right</button>\n            <button class="wrong btn">wrong</button>\n          </div>\n        </div>\n  \n      </div>\n      </div>\n    `)}game(){this.renderGame(),this.timer(),this.fullscreen(),this.volume(),this.round();const t=document.querySelector(".right"),e=document.querySelector(".wrong");t.addEventListener("click",this.right),e.addEventListener("click",this.wrong),document.querySelector(".navigation").addEventListener("click",(t=>{const e=t.target;e.dataset.navigation&&"games"!==e.dataset.navigation&&(this.TIMER_COUNT=1)}))}updateStatistics(){return n(this,void 0,void 0,(function*(){try{const t=yield(new c.Fetch).GET_STATISTICS();delete t.id,t.optional?t.optional.sprint?(t.optional.sprint.correct+=this.sprintStatistic.correct,t.optional.sprint.wrong+=this.sprintStatistic.wrong,t.optional.sprint.newWords+=this.sprintStatistic.newWords,t.optional.sprint.maxRow<=this.sprintStatistic.maxRow&&(t.optional.sprint.maxRow=this.sprintStatistic.maxRow)):Object.defineProperty(t.optional,"sprint",{value:{correct:this.sprintStatistic.correct,wrong:this.sprintStatistic.wrong,newWords:this.sprintStatistic.newWords,maxRow:this.sprintStatistic.maxRow}}):Object.defineProperty(t,"optional",{value:{sprint:{correct:this.sprintStatistic.correct,wrong:this.sprintStatistic.wrong,newWords:this.sprintStatistic.newWords,maxRow:this.sprintStatistic.maxRow}}}),yield(new c.Fetch).UPDATE_STATISTICS(t)}catch(t){const e={learnedWords:0,optional:{sprint:{newWords:this.sprintStatistic.newWords,correct:this.sprintStatistic.correct,wrong:this.sprintStatistic.wrong,maxRow:this.sprintStatistic.maxRow}}};yield(new c.Fetch).UPDATE_STATISTICS(e)}}))}stopGame(){return n(this,void 0,void 0,(function*(){const t=document.querySelector(".sprint-wrapper"),e=document.querySelector(".game-area");e&&(e.innerHTML="");const s={group:this.group,page:this.page,points:this.points,total:this.answers,inRow:this.maxrow,rightCount:this.rightAnswers,wrongCount:this.mistakes,answersArr:this.rightAnswersArr.concat(this.mistakesArr),gameName:"sprint"};this.remove(),t&&(this.auth&&(this.words.forEach((t=>n(this,void 0,void 0,(function*(){const e=t._id?t._id:t.id;(yield h.GET_AGGREGATED_WORDS_BY_ID(e))[0].userWord?yield h.UPDATE_USER_WORDS_BY_ID(e,t.userWord):yield h.CREATE_USER_WORDS(e,t.userWord)})))),this.sprintStatistic.correct=this.rightAnswers,this.sprintStatistic.wrong=this.mistakes,this.sprintStatistic.maxRow=this.maxrow,this.updateStatistics()),new u.GameResult(s).render(this.MAIN_WRAPPER))}))}}},31:function(t,e,s){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),s(90);const i=s(718),r=s(428),a=s(179),o=n(s(613)),d=s(73),l=s(869);e.default=class{constructor(t){this.processClick=t=>{if(t.target instanceof HTMLElement){let e=t.target;if("level-item"===e.className||"label"===e.className){const t=Array.from(document.querySelectorAll(".level-item"));"label"===e.className&&(e=e.offsetParent);const s=String(t.indexOf(e));document.querySelector(".navigation .active"),this.renderPageByAttr(this.target,s)}}},this.renderPageByAttr=(t,e)=>{const s=new l.Spinner;switch(t){case"book":new d.BookPage(e).renderBookPage();break;case"sprint":s.startTimer((()=>{new r.Sprint(e).startGame()}));break;case"audiocall":s.startTimer((()=>{new a.AudioCall(e).startGame()}))}},this.MAIN_WRAPPER=document.querySelector(".main__wrapper"),this.LEVEL_PAGE=document.createElement("section"),this.LEVEL_PAGE.className="level-page page",this.target=t}renderLevelPage(){this.MAIN_WRAPPER.innerHTML="",this.LEVEL_PAGE.innerHTML='\n      <div class="wrapper">\n      <div class="level-page__content">\n        <div class="levels">\n          <div class="level-item">\n            <div class="label">A1</div>\n            <span class="label-title">Elementary</span>\n          </div>\n          <div class="level-item">\n            <div class="label">A2</div>\n            <span class="label-title">Pre-Intermediate</span>\n          </div>\n          <div class="level-item">\n            <div class="label">B1</div>\n            <span class="label-title">Intermediate</span>\n          </div>\n          <div class="level-item">\n            <div class="label">B2</div>\n            <span class="label-title">Upper-Intermediate</span>\n          </div>\n          <div class="level-item">\n            <div class="label">C1</div>\n            <span class="label-title">Advanced</span>\n          </div>\n          <div class="level-item">\n            <div class="label">C2</div>\n            <span class="label-title">Proficiency</span>\n          </div>\n        </div>\n      </div>\n      </div>',this.MAIN_WRAPPER.append(this.LEVEL_PAGE),(0,o.default)(this.MAIN_WRAPPER),this.LEVEL_PAGE.addEventListener("click",this.processClick);const t=document.querySelector(".navigation .active");if(t.dataset.navigation&&"book"===t.dataset.navigation){const t=document.querySelector(".levels");t.insertAdjacentHTML("afterend",'\n          <div class="level-page__description_wrapper">\n            <div class="level-page__description">\n              <p class="subtitle">\n              <span>Электронный учебник</span> - библиотека из 3600 часто встречающихся слов. \n              Слова в коллекции отсортированы от более простых и известных к более сложным.\n              Авторизированные пользователи могут отмечать слова как "сложные" и "изученные"!\n              Сложные слова будут доступны в отдельном разделе, для отдельного их повторения. \n              Изученные слова не будут участвовать в играх, запущенных со страниц учебника.\n              </p>\n            </div>\n            \n            <img\n            src="./assets/images/background-guys/man-reading-newspaper.svg"\n            class="level-img"\n            alt="img"\n            />\n          </div>\n        '),(0,i.isUserExists)()&&t.insertAdjacentHTML("beforeend",'\n            <div class="level-item">\n            <div class="label">HARD</div>\n            <span class="label-title">Hard words</span>\n            </div>\n            ')}}}},438:function(t,e,s){var n=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(i,r){function a(t){try{d(n.next(t))}catch(t){r(t)}}function o(t){try{d(n.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,o)}d((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LoginPage=void 0;const r=s(352),a=i(s(613));s(658);const o=s(718),d=s(250);e.LoginPage=class{constructor(){this.processClick=t=>n(this,void 0,void 0,(function*(){if(!(t.target instanceof HTMLElement))return;const e=t.target;if(e.dataset.login)switch(e.dataset.login){case"render-signup":return void this.renderSignUpPage();case"render-login":return void this.renderLoginPage();case"signup":if(this.isFormsEmpty())this.dropError();else{const t=document.querySelector('input[type="text"]').value,e=document.querySelector('input[type="email"]').value,s=document.querySelector('input[type="password"]').value;this.validateEmail(e)?this.validatePassword(s)&&this.signUp(t,e,s):this.dropError(464)}return;case"login":if(this.isFormsEmpty())this.dropError();else{const t=document.querySelector('input[type="email"]').value,e=document.querySelector('input[type="password"]').value;this.validateEmail(t)?this.validatePassword(e)&&this.login(t,e):this.dropError(464)}return}})),this.validateEmail=t=>/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(String(t).toLowerCase()),this.validatePassword=t=>/^\D.*$/.test(t)?/^[^-()=+/]*$/.test(t)?/^.{8,}$/.test(t)?!/\s/.test(t)||(this.dropError(463),!1):(this.dropError(462),!1):(this.dropError(461),!1):(this.dropError(460),!1),this.renderLoginPage=()=>{this.MAIN_WRAPPER.innerHTML="",this.LOGIN_PAGE.innerHTML='\n        <div class="login-page__title">\n            <h2>Авторизируйтесь</h2>\n            <p>и используйте возможности RSLang на максимум!</p>\n        </div>\n\n        <input class="login-page__input" type="email" placeholder="Введите e-mail">\n\n        <input class="login-page__input" type="password" placeholder="Введите пароль">\n\n        <div class="login-page__button_wrapper">\n            <button class="login-page__button" data-login="login">ВОЙТИ</button>\n            <p>Еще нет аккаунта? Самое время <a data-login="render-signup">создать</a>!</p>\n        </div>\n        ',this.MAIN_WRAPPER.prepend(this.LOGIN_PAGE),(0,a.default)(this.MAIN_WRAPPER)},this.renderSignUpPage=()=>{this.MAIN_WRAPPER.innerHTML="",this.LOGIN_PAGE.innerHTML='\n            <div class="login-page__title">\n                <h2>Зарегистрируйтесь</h2>\n                <p>и используйте возможности RSLang на максимум!</p>\n            </div>\n\n            <input class="login-page__input" type="text" placeholder="Введите имя">\n            <input class="login-page__input" type="email" placeholder="Введите e-mail" autocomplete="off">\n            <input class="login-page__input" type="password" placeholder="Введите пароль" autocomplete="off">\n            <div class="login-page__button_wrapper">\n                <button class="login-page__button" data-login="signup">СОЗДАТЬ АККАУНТ</button>\n                <p>Уже есть аккаунт? Тогда стоит в него <a data-login="render-login">войти</a>!</p>\n            </div>\n        ',this.MAIN_WRAPPER.prepend(this.LOGIN_PAGE),(0,a.default)(this.MAIN_WRAPPER)},this.signUp=(t,e,s)=>n(this,void 0,void 0,(function*(){const n={name:t,email:e,password:s};try{yield this.FETCH.CREATE_USER(n),yield this.login(e,s)}catch(t){this.dropError(t.status)}})),this.login=(t,e)=>n(this,void 0,void 0,(function*(){const s={email:t,password:e};try{const t=yield this.FETCH.SIGN_IN(s);localStorage.setItem("UserInfo",JSON.stringify(t)),yield(0,o.checkStatsDay)(),this.redirectToMain()}catch(t){this.dropError(t.status)}})),this.redirectToMain=()=>{var t;const e=document.querySelector('[data-navigation="login"]');e&&(e.dataset.navigation="logout",e.innerHTML="Выйти",e.classList.remove("active"),null===(t=document.querySelector('[data-navigation="main"]'))||void 0===t||t.classList.add("active"),(new d.Router).renderPage())},this.isFormsEmpty=()=>{const t=document.querySelectorAll("input");let e=!1;for(let s of t)s.value||(e=!0);return e},this.dropError=t=>{const e=document.querySelector(".error");e&&e.remove();const s=document.createElement("p");switch(s.className="error",t){case 403:s.innerHTML="Неправильный пароль!";break;case 404:s.innerHTML="Такого пользователя нет!";break;case 417:s.innerHTML="Эта почта уже зарегистрирована!";break;case 460:s.innerHTML="Нельзя начинать пароль с числа!";break;case 461:s.innerHTML="Используйте числа, буквы и нижнее подчеркивание!";break;case 462:s.innerHTML="Используйте миним 8 символов!";break;case 463:s.innerHTML="Нельзя использовать пробелы!";break;case 464:s.innerHTML="Некоректный email!";break;default:s.innerHTML="Нужно заполнить все поля!"}const n=document.querySelector(".login-page__button_wrapper");n&&(n.prepend(s),setTimeout((()=>s.remove()),5e3))},this.MAIN_WRAPPER=document.querySelector(".main__wrapper"),this.LOGIN_PAGE=document.createElement("main"),this.LOGIN_PAGE.className="login-page page",this.LOGIN_PAGE.addEventListener("click",this.processClick),this.FETCH=new r.Fetch}},window.addEventListener("load",(()=>{if((0,o.isUserExists)()){const t=document.querySelector('[data-navigation="login"]');t.dataset.navigation="logout",t.innerHTML="Выйти"}}))},366:function(t,e,s){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MainPage=void 0;const i=n(s(613)),r=s(250);s(264),e.MainPage=class{constructor(){this.processClick=t=>{if(!(t.target instanceof HTMLElement))return;const e=t.target;if(!e.closest("[data-main]"))return;let s;s=e.dataset.main?e.dataset.main:e.closest("[data-main]").dataset.main||"main",(new r.Router).renderPage(s)},this.MAIN_WRAPPER=document.querySelector(".main__wrapper"),this.MAIN_PAGE=document.createElement("main"),this.MAIN_PAGE.className="main-page page"}renderMainPage(){this.MAIN_WRAPPER.innerHTML="",this.MAIN_PAGE.innerHTML=this.content(),this.MAIN_WRAPPER.append(this.MAIN_PAGE),(0,i.default)(this.MAIN_WRAPPER),this.MAIN_PAGE.addEventListener("click",this.processClick)}content(){return'\n        <div class="main-page__title">\n          <p>Добро пожаловать в</p>\n          <h1><span>RS</span>Lang</h1>\n          <p>лучшее место для изучения английского языка!</p>\n        </div>\n        <div class="main-page__cards">\n          <div class="main-page__card" data-main="book">\n            <div class="card-img__wrapper">\n              <img src="./assets/images/mainPage/0.png" alt="" />\n            </div>\n            <h3 class="card__title">Изучай</h3>\n            <p class="card__text">\n              В вашем распоряжении коллеция, содержащая 3600 \n              часто употребляемых английских слов.\n            </p>\n          </div>\n          <div class="main-page__card" data-main="book-hard">\n            <div class="card-img__wrapper">\n              <img src="./assets/images/mainPage/1.png" alt="" />\n            </div>\n            <h3 class="card__title">Запоминай</h3>\n            <p class="card__text">\n              Для лучшего запонимания сложных слов отмечай их и повторяй\n              отдельно\n            </p>\n          </div>\n          <div class="main-page__card" data-main="games">\n            <div class="card-img__wrapper">\n              <img src="./assets/images/mainPage/2.png" alt="" />\n            </div>\n            <h3 class="card__title">Играй</h3>\n            <p class="card__text">\n              Упражняйся, играя в наши мини-игры и делись результатами с друзьями\n            </p>\n          </div>\n          <div class="main-page__card" data-main="stats">\n            <div class="card-img__wrapper">\n              <img src="./assets/images/mainPage/3.png" alt="" />\n            </div>\n            <h3 class="card__title">Анализируй</h3>\n            <p class="card__text">\n              Подробная статистика твоих достижений, изученных слов и ошибок\n            </p>\n          </div>\n        </div>\n        \n    '}}},570:function(t,e,s){var n=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(i,r){function a(t){try{d(n.next(t))}catch(t){r(t)}}function o(t){try{d(n.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,o)}d((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),s(87);const r=s(718),a=i(s(613)),o=s(352),d=i(s(568));e.default=class{constructor(){this.renderStatsPage=()=>n(this,void 0,void 0,(function*(){var t,e,s,n,i,o,l,c,u,h,p,g,v,_,m,w,f;if(this.MAIN_WRAPPER.innerHTML="",!(0,r.isUserExists)())return void(new d.default).renderErrorPage();let E,A;this.MAIN_WRAPPER.append(this.STATS_PAGE),(0,a.default)(this.MAIN_WRAPPER),E=yield this.FETCH.GET_STATISTICS(),A=((null===(t=(yield this.FETCH.GET_AGGREGATED_WORDS({filter:`{"$and":[{"userWord.difficulty":"easy", "userWord.optional.learnDate":"${(0,r.getTodayDate)()}"}]}`}))[0].totalCount[0])||void 0===t?void 0:t.count)||0)+E.learnedWords;const y=(null===(s=null===(e=E.optional)||void 0===e?void 0:e.audioCall)||void 0===s?void 0:s.correct)||0,S=(null===(i=null===(n=E.optional)||void 0===n?void 0:n.audioCall)||void 0===i?void 0:i.wrong)||0,b=(null===(l=null===(o=E.optional)||void 0===o?void 0:o.audioCall)||void 0===l?void 0:l.newWords)||0;let P=Math.round(y/(y+S)*100);P=isNaN(P)?0:P;const R=(null===(u=null===(c=E.optional)||void 0===c?void 0:c.sprint)||void 0===u?void 0:u.correct)||0,T=(null===(p=null===(h=E.optional)||void 0===h?void 0:h.sprint)||void 0===p?void 0:p.wrong)||0,L=(null===(v=null===(g=E.optional)||void 0===g?void 0:g.sprint)||void 0===v?void 0:v.newWords)||0;let C=Math.round(R/(R+T)*100);C=isNaN(C)?0:C;const k=y+S+R+T,I=Math.round((y+R)/k*100),W=b+L;document.body.style.setProperty("--p1",`${I}`),this.STATS_WRAPPER.innerHTML=`\n        <h2 class="stats-page__title">Статистика за сегодня</h2>\n        <div class="stats-page__card words">\n            <p>Новых слов сегодня</p>\n            <h2>${W}</h2>\n            <p>Изучено слов сегодня</p>\n            <h2>${A}</h2>\n        </div>\n\n        <div class="stats-page__card accuracy">\n            <div class="accuracy-percentage">${isNaN(I)?0:I}%</div>\n            <p>Ваша точность</p>\n        </div>\n\n        <div class="stats-page__card game">\n            <h3>Спринт</h3>\n            <div class="game-stats__wrapper">\n                <p><span class="words">${L}</span> - новые слова</p>\n                <p><span class="accuracy">${C}%</span> - точность</p>\n                <p><span class="row">${(null===(m=null===(_=E.optional)||void 0===_?void 0:_.sprint)||void 0===m?void 0:m.maxRow)||0}</span> - лучшая серия</p>\n            </div>\n        </div>\n\n        <div class="stats-page__card game">\n            <h3>Аудиовызов</h3>\n            <div class="game-stats__wrapper">\n                <p><span class="words">${b}</span> - новые слова</p>\n                <p><span class="accuracy">${P}%</span> - точность</p>\n                <p><span class="row">${(null===(f=null===(w=E.optional)||void 0===w?void 0:w.audioCall)||void 0===f?void 0:f.maxRow)||0}</span> - лучшая серия</p>\n            </div>\n        </div>\n        `,this.STATS_PAGE.append(this.STATS_WRAPPER)})),this.MAIN_WRAPPER=document.querySelector(".main__wrapper"),this.STATS_PAGE=document.createElement("main"),this.STATS_PAGE.className="stats-page page",this.STATS_WRAPPER=document.createElement("div"),this.STATS_WRAPPER.className="stats-page__wrapper",this.FETCH=new o.Fetch}}},378:function(t,e,s){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=n(s(613));s(700),e.default=class{constructor(){this.teamPageContent=()=>'\n    <div class="team__wrapper">\n      <div class="team__card">\n        <div class="img-border">\n          <div class="img avlasenko"></div>\n        </div>\n        <div class="info">\n          <h2 class="info__name"><a class="info__name_link" href="https://github.com/AvlasenkoPetr" target="_blink"></a>Avlasenko Petr</h2>\n          <p class="info__contribution">\n            Навигация, авторизация, электронный учебник, страница статистики, страница выбора игр, главная страница (навигация), страница "ошибки".\n          </p>\n        </div>\n      </div>\n      \n      <div class="team__card">\n        <div class="img-border">\n          <div class="img skrinnik"></div>\n        </div>\n        <div class="info">\n          <h2 class="info__name"><a class="info__name_link" href="https://github.com/rakyt4gin" target="_blink"></a>Andrei Skrinnik</h2>\n          <p class="info__contribution">\n            Игра "Аудиовызов", интерфейс взаимодействия с сервером, модальное окно для результатов игр, главная страница (верстка). \n          </p>\n        </div>\n      </div>\n      \n      <div class="team__card">\n        <div class="img-border">\n          <div class="img arakelyan"></div>\n        </div>\n        <div class="info">\n          <h2 class="info__name"><a class="info__name_link" href="https://github.com/Prizzz" target="_blink"></a>Robert Arakelyan</h2>\n          <p class="info__contribution">\n            Игра "Спринт", дизайн, страница выбора уровня сложности, предзагрузочный экран для миниигр.\n          </p>\n        </div>\n      </div>\n    </div>\n    ',this.MAIN_WRAPPER=document.querySelector(".main__wrapper"),this.TEAM_PAGE=document.createElement("main"),this.TEAM_PAGE.className="team-page page"}renderTeamPage(){this.MAIN_WRAPPER.innerHTML="",this.TEAM_PAGE.innerHTML=this.teamPageContent(),this.MAIN_WRAPPER.append(this.TEAM_PAGE),(0,i.default)(this.MAIN_WRAPPER)}}},250:function(t,e,s){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Router=void 0;const i=s(366),r=s(438),a=n(s(31));s(510);const o=s(73),d=s(718),l=n(s(910)),c=n(s(570)),u=n(s(378)),h=n(s(568));e.Router=class{constructor(){this.processClick=t=>{if(!(t.target instanceof HTMLElement))return;const e=t.target;if(!e.dataset.navigation)return;const s=e.dataset.navigation;if("open"===s)return void this.openMenu();if("alter"===s)return void document.body.classList.toggle("alter");if("logout"===s)return localStorage.removeItem("UserInfo"),e.dataset.navigation="login",e.innerHTML="Войти",void window.location.reload();const n=this.NAV_BLOCK.querySelector(".active");if(n){if(n.dataset.navigation===s)return;n.classList.remove("active")}if(e.closest("aside"))e.classList.add("active");else{const t=this.NAV_BLOCK.querySelector(`[data-navigation=${s}]`);null==t||t.classList.add("active")}this.renderPage(s)},this.openMenu=()=>{var t;this.NAV_BLOCK.classList.toggle("opened"),null===(t=this.NAV_BLOCK.querySelector(".button-open"))||void 0===t||t.classList.toggle("opened")},this.renderPage=(t="main")=>{this.setLastPageToLocalStorage(t),this.setActivePage(t);const e=new CustomEvent("removeEventListeners");switch(window.dispatchEvent(e),t){case"main":return void(new i.MainPage).renderMainPage();case"book":return void new a.default(t).renderLevelPage();case"book-hard":return this.setActivePage("book"),(0,d.isUserExists)()?void new o.BookPage("6").renderBookPage():void(new h.default).renderErrorPage();case"games":return void(new l.default).renderGamesPage();case"stats":return void(new c.default).renderStatsPage();case"team":return void(new u.default).renderTeamPage();case"login":return void(new r.LoginPage).renderLoginPage()}},this.NAV_BLOCK=document.querySelector(".aside")}setListener(){this.NAV_BLOCK.addEventListener("click",this.processClick)}setLastPageToLocalStorage(t){localStorage.setItem("lastPage",t)}setActivePage(t){document.querySelector(".navigation").querySelectorAll("li").forEach((e=>{e.dataset.navigation===t?e.classList.add("active"):e.classList.remove("active")}))}}},814:(t,e,s)=>{t.exports=s.p+"assets/images/audioCall/audio-button.svg"},285:(t,e,s)=>{t.exports=s.p+"assets/images/audioCall/fullScreen.svg"},519:(t,e,s)=>{t.exports=s.p+"assets/images/navigation/audiocall-black.svg"},315:(t,e,s)=>{t.exports=s.p+"assets/images/navigation/sprint-black.svg"},78:(t,e,s)=>{t.exports=s.p+"assets/images/sprint/audio-off.svg"},421:(t,e,s)=>{t.exports=s.p+"assets/images/sprint/audio-on.svg"},566:(t,e,s)=>{t.exports=s.p+"assets/sounds/correct.mp3"},846:(t,e,s)=>{t.exports=s.p+"assets/sounds/incorrect.mp3"}},e={};function s(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,s),r.exports}s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t+"../"})(),(()=>{s(662),s(126);const t=s(718);s(264),(new(s(250).Router)).setListener(),(0,t.getLastPage)(),(0,t.isUserExists)()&&(0,t.checkStatsDay)()})()})();